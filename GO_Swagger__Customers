# this is draft #1 of the Customers component of the WebAPI specification for Gateway Ordering
swagger: '2.0'
info:
  title: Gateway Ordering API - Customers API
  description: Gateway Ordering Customers API
  version: "1.0.0"
# the domain of the service
host: gateway.chartercom.com
# array of all schemes that your API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /v1
produces:
  - application/json
paths:
  /customers:
    get:
      summary: Docref W02 - Retrieve customer ID, account ID, and related account information
      description: Retrieves information on a person or entity previously known to Charter but who does not have a (readily previously identified) active account
      parameters:
        - name: CommonInputHeader
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/CommonInputHeader"
        - name: firstName
          in: query
          type: string
          description: <dr>
        - name: lastName
          in: query
          type: string
          description: <dr>
        - name: primaryTN
          in: query
          type: string
          description: <dr>
        - name: primaryTNType
          in: query
          type: string
          description: <dr>
        - name: alternateTN
          in: query
          type: string
          description: <dr>
        - name: alternateTNType
          in: query
          type: string
          description: <dr>
        - name: email
          in: query
          type: string
          description: <dr>
        - name: customerID
          in: query
          type: integer
          description: <dr>
        - name: addressID
          in: query
          type: integer
          description: <dr>

      tags:
        - W02
      responses:
        200:
          description: Successful completion; return key IDs
          schema:
            $ref: '#/definitions/GetCustomerIDResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

  /customers/{customerID}:
    get:
      summary: Docref W17 - Retrieve key customer information
      description: <dr>
      parameters:
        - name: customerID
          in: path
          type: integer
          description: Unique identifier for the Customer being queried
        - name: CommonInputHeader
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/CommonInputHeader"
      tags:
        - W17
      responses:
        200:
          description: Successful completion; return expanded customer information
          schema:
            $ref: '#/definitions/GetCustomerInformationResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

  /customers/{customerID}/PII:
    post:
      summary: Docref W11 precursor - Collect key personal identifying information (PII) for the specified customer.  Submitting the PII collection will trigger a credit check based on the PII supplied.
      description: <dr>
      parameters:
        - name: customerID
          in: path
          type: integer
          description: Unique identifier for the Customer for which PII is being collected
        - name: CustomerCreditCheckRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/CustomerCreditCheckRequest"
      tags:
        - W11
      responses:
        200:
          description: Successful completion; return credit check result
          schema:
            $ref: '#/definitions/CustomerCreditCheckResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

  /customers/account/{accountID}/billAddress:
    post:
      summary: Docref W23 - update account billing address
      description: <dr>
      parameters:
        - name: accountID
          in: path
          type: integer
          description: Unique identifier for the Customer's account being updated
        - name: BillingAddressUpdateRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/BillingAddressUpdateRequest"
      tags:
        - W23
      responses:
        200:
          description: Successful completion; return updated account information
          schema:
            $ref: '#/definitions/BillingAddressUpdateResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

  /customers/account/{accountID}:
    get:
      summary: Docref W14 - Get Landing Page Info
      description: An orchestration of a number of enterprise services - getAccountStatus, getCustomerAndAccountDetails, getPastDueBalance, getOrderHistory, and getOutageInformation
      parameters:
        - name: accountID
          in: path
          type: integer
          description: Unique identifier for the account being queried
        - name: GetLandingPageRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/GetLandingPageRequest"
      tags:
        - W14
      responses:
        200:
          description: Successful completion; return expanded customer information
          schema:
            $ref: '#/definitions/GetLandingPageResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

definitions:

##############################################
#
#	Request/Response definitions
#
##############################################

#  GetCustomerIDRequest:
#    properties:
#      commonInputHeader:
#        type: object
#        $ref: '#/definitions/CommonInputHeader'
#        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
#      customerAccountLookupInput:
#        type: object
#        $ref: '#/definitions/customerAccountLookupInput'
#        description: <dr>
                  
  GetCustomerIDResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      customerAccountLookupReturn:
        type: array
        items:
          $ref: '#/definitions/customerAccountLookupReturn'
        description: <dr>

#  GetCustomerInformationRequest:
#    properties:
#      commonInputHeader:
#        type: object
#        $ref: '#/definitions/CommonInputHeader'
#        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
                  
  GetCustomerInformationResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      CustomerInformationResponse:
        type: object
        $ref: '#/definitions/customerInformationReturn'
            
  CustomerCreditCheckRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      customerCreditCheckInput:
        type: object
        $ref: '#/definitions/customerCreditCheckInput'
        description: <dr>
         
  CustomerCreditCheckResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      customerCreditCheckReturn:
        type: object
        $ref: '#/definitions/customerCreditCheckReturn'
        description: <dr>

  BillingAddressUpdateRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      addressUpdate:
        type: object
        $ref: '#/definitions/addressUpdate'
        description: <dr>
                  
  BillingAddressUpdateResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>

  GetLandingPageRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
                  
  GetLandingPageResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>

##############################################
#
#	Common Object definitions
#
##############################################

  CommonInputHeader:
    properties:
      username:
        type: string
        description: Encrypted username for proxy user authentication
      password:
        type: string
        description: Encrypted passaord for proxy user authentication
      invokingUser:
        type: string
        description: User name for the actual user that invoked the call (for audit purpose)
      applicationID:
        type: string
        description: Code identifying invoking application
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was invoked

  CommonNoErrorReturnHeader:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
        
  CommonErrorReturn:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
      errorInfo:
        type: array
        items:
          $ref: "#/definitions/CommonErrors"
  
  CommonErrors:
    properties:
      errCode:
        type: string
      errMessage:
        type: string
      errDescription:
        type: string
      errGUID:
        type: string

##############################################
#
#	Function-Specific Object definitions
#
##############################################

#  customerAccountLookupInput:
#    properties:
#      firstName:
#        type: string
#        description: <dr>
#      lastName:
#        type: string
#        description: <dr>
#      primaryTN:
#        type: string
#        description: <dr>
#      primaryTNType:
#        type: string
#        description: <dr>
#      alternateTN:
#        type: string
#        description: <dr>
#      alternateTNType:
#        type: string
#        description: <dr>
#      email:
#        type: string
#        description: <dr>
#      customerID:
#        type: integer
#        description: <dr>
#      addressID:
#        type: integer
#        description: <dr>
        
  customerAccountLookupReturn:
    properties:
      customerType:
        type: string
        description: <dr>
      accountID: 
        type: integer
        description: <dr>
      accountNumber: 
        type: string
        description: <dr>
      billerID:
        type: integer
        description: <dr>
      customerID:
        type: integer
        description: <dr>
      addressID:
        type: integer
        description: <dr>

  customerInformationReturn:
    properties:
      firstName:
        type: string
        description: <dr>
      lastName:
        type: string
        description: <dr>
      primaryTN:
        type: string
        description: <dr>
      primaryTNType:
        type: string
        description: <dr>
      alternateTN:
        type: string
        description: <dr>
      alternateTNType:
        type: string
        description: <dr>
      email:
        type: string
        description: <dr>
      customerID:
        type: integer
        description: <dr>

  customerCreditCheckInput:
    properties:
      firstName:
        type: string
        description: <dr>
      lastName:
        type: string
        description: <dr>
      currentAddress:
        type: object
        $ref: '#/definitions/postalAddress'
      orderActionType:
        type: string
        description: <dr>
      orderAmount:
        type: number
        description: <dr>
      previousAddress:
        type: object
        $ref: '#/definitions/postalAddress'
      PII:
        type: object
        $ref: '#/definitions/customerPII'
          
  postalAddress:
    properties:
      addressLine1:
        type: string
        description: <dr>
      addressLine2:
        type: string
        description: <dr>
      addressCity:
        type: string
        description: <dr>
      addressStateCode:
        type: string
        description: <dr>
      addressZIPCode:
        type: string
        description: <dr>
        
  customerPII:
    properties:
      socialSecurityNumber:
        type: string
        description: <dr>
      driverLicenseNumber:
        type: string
        description: <dr>
      driverLicenseStateCode:
        type: string
        description: <dr>
      dateOfBirth:
        type: string
        format: date
        description: <dr>

  customerCreditCheckReturn:
    properties:
      experianPIN:
        type: string
        description: <dr>
      BadAccountInformation:
        type: array
        items:
          $ref: '#/definitions/DerogatoryCreditInformation'
      FTAPrepaymentRequiredFlag:
        type: boolean
        description: <dr>
      creditHistoryRankingAssessment:
        type: string
        description: <dr>
      
  DerogatoryCreditInformation:    
    properties:
      accountNumber:
        type: string
        description: <dr>
      outstandingBalance:
        type: number
        format: double
        description: <dr>
      nonPayDisconnectStatus:
        type: string
        description: <dr>
      unreturnedEquipmentFlag:
        type: boolean
        description: <dr>
      prepayRequired:
        type: boolean
        description: <dr>
      prepayAmountBadDebt:
        type: number
        format: double
      prepayAmountUnreturnedEquipment:
        type: number
        format: double
        
  addressUpdate:
    properties:
      newAddress:
        type: object
        $ref: '#/definitions/postalAddress'
