# this is draft #1 of the Locations component of the WebAPI specification for Gateway Ordering
swagger: '2.0'
info:
  title: Gateway Ordering API - Locations API
  description: Gateway Ordering Locations API
  version: "1.0.0"
# the domain of the service
host: gateway.chartercom.com
# array of all schemes that your API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /v1
produces:
  - application/json
paths:

  /serviceability/{AddressID}:
    get:
      summary: Docref W13, W18 - Determine serviceability at location/address
      description: Determine the products and services eligible for sale at the requested address/location.  The same service will be used to determine both "New Connect" location service compatability as well as "Transfer-To" Location service compatability.  Boolean value for serviceability (is/is not serivceable) can be inferred from the existence of rows in the service return data set. 
      parameters:
        - name: AddressID
          in: path
          required: true
          type: integer
          description: Unique identifier for the address/location being queried for serviceability
        - name: lineageID
          in: header
          required: true
          type: string
          description: Unique transaction identifier; used for transactional error handling
        - name: timestamp
          in: header
          required: true
          type: string
          format: date-time
          description: Time that the service call was invoked
        - name: invokingUser
          in: header
          required: true
          type: string
          description: User name for the actual user that invoked the call (for audit purpose)
        - name: applicationID
          in: header
          required: true
          type: string
          description: Code identifying invoking application or sales channel
      tags:
        - W13
        - W18
      responses:
        200:
          description: Successful completion; return location serviceability
          schema:
            $ref: '#/definitions/ServiceabilityAtLocationResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

  /serviceability/{AddressID}/Active:
    get:
      summary: Docref W16 - Get active services at location
      description: Retrieves the list of products and services currently active at the queried address/location.
      parameters:
        - name: AddressID
          in: path
          required: true
          type: integer
          description: Unique identifier for the address being checked
        - name: lineageID
          in: header
          required: true
          type: string
          description: Unique transaction identifier; used for transactional error handling
        - name: timestamp
          in: header
          required: true
          type: string
          format: date-time
          description: Time that the service call was invoked
        - name: invokingUser
          in: header
          required: true
          type: string
          description: User name for the actual user that invoked the call (for audit purpose)
        - name: applicationID
          in: header
          required: true
          type: string
          description: Code identifying invoking application or sales channel

      tags:
        - W16
      responses:
        200:
          description: Successful completion; return <function>
          schema:
            $ref: '#/definitions/ActiveServicesAtLocationResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'
       		      
  /Locations:
    get:
      summary: Docref W13, W18 precursor - Search for Location ID from within Gateway Ordering Application
      description: Retrieves a specific location identifier (AddressID) based on a set of address parameters. Precursor to retrieving serviceability by location.  Overlaps with existing adaptive Search capability such that if adaptive capabilities can be referenced from within the Gateway Ordering application (with the appropriate data feeds) this function (and possibly the serviceabiltyAtLocation function as well) may be pre-empted. Application will force collection of sufficient data to ensure a maximum of 1 location ID will be returned.
      parameters:
        - name: lineageID
          in: header
          required: true
          type: string
          description: Unique transaction identifier; used for transactional error handling
        - name: timestamp
          in: header
          required: true
          type: string
          format: date-time
          description: Time that the service call was invoked
        - name: invokingUser
          in: header
          required: true
          type: string
          description: User name for the actual user that invoked the call (for audit purpose)
        - name: applicationID
          in: header
          required: true
          type: string
          description: Code identifying invoking application or sales channel
        - name: addrStreetLine1
          type: string
          in: query
          required: true
          description: Line 1 of the street address component of the address lookup 
        - name: addrStreetLine2
          type: string
          in: query
          required: false
          description: Line 2 of the street address component of the address lookup  
        - name: addrCity
          type: string
          in: query
          required: false
          description: City component of the address lookup
        - name: addrState
          type: string
          in: query
          required: false
          description: State component of the address lookup
        - name: addrZIP
          type: string
          in: query
          required: false
          description: ZIP Code component of the address lookup
          
      tags:
        - W18
      responses:
        200:
          description: Successful completion; return location serviceability
          schema:
            $ref: '#/definitions/LocationIDLookupResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

definitions:

##############################################
#
#	Request/Response definitions
#
##############################################

#  ServiceableLocationRequest:
#    properties:
#      commonInputHeader:
#        type: object
#        $ref: '#/definitions/CommonInputHeader'
#        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
#      commonAddress:
#        type: object
#        $ref: '#/definitions/locationLookupByAddress'
#        decription: <dr>
#                  
  LocationIDLookupResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      locationID:
        type: integer
        description: Unique identifier for the location.

#  ServiceabilityAtLocationRequest:
#    properties:
#      commonInputHeader:
#        type: object
#        $ref: '#/definitions/CommonInputHeader'
#        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
  
  ServiceabilityAtLocationResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
#      locationServiceabilityDetail: 
#        type: object
#        $ref: '#/definitions/LocationServiceabilityDetail'
#        description: <dr>
      addressID:
        description: Address/location identifier being queried for serviceability
      dwellingType:
        type: string
        description: Code describing the type of dwelling present at the location.
      managementArea:
        type: string
        description: Telephone number management area.
      rateCenter:
        type: string
        description: Rate center associated with the location.
      market:
        type: string
        description: Market associated with the location.
      FTA:
        type: string
        description: Franchise tax area associated with the location.
      lobProductServiceability:
        type: array
        items:
          $ref: '#/definitions/LoBProductServiceability'
      overbuilderIndicator:
        type: array
        items:
          type: string

#  ActiveServicesAtLocationRequest:
#    properties:
#      commonInputHeader:
#        type: object
#        $ref: '#/definitions/CommonInputHeader'
#        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
  
  ActiveServicesAtLocationResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      ActiveServices:
        type: array
        items:
          $ref: '#/definitions/LoBLocationActiveProduct'

##############################################
#
#	Common Object definitions
#
##############################################

#  CommonInputHeader:
#    properties:
#      username:
#        type: string
#        description: Encrypted username for proxy user authentication
#      password:
#        type: string
#        description: Encrypted passaord for proxy user authentication
#      invokingUser:
#        type: string
#        description: User name for the actual user that invoked the call (for audit purpose)
#      applicationID:
#       type: string
#       description: Code identifying invoking application
#      lineageID:
#       type: integer
#        description: Unique transaction identifier; used for transactional error handling
#      timestamp:
#        type: string
#        description: Time that the service call was invoked

  CommonNoErrorReturnHeader:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
        
  CommonErrorReturn:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
      errorInfo:
        type: array
        items:
          $ref: "#/definitions/CommonErrors"
  
  CommonErrors:
    properties:
      errCode:
        type: string
      errMessage:
        type: string
      errDescription:
        type: string
      errGUID:
        type: string

##############################################
#
#	Function-Specific Object definitions
#
##############################################

#  LocationServiceabilityDetail:
#    properties:
#      addressID:
#        description: Address/location identifier being queried for serviceability
#      dwellingType:
#        type: string
#        description: Code describing the type of dwelling present at the location.
#      managementArea:
#        type: string
#        description: Telephone number management area.
#      rateCenter:
#        type: string
#        description: Rate center associated with the location.
#      market:
#        type: string
#        description: Market associated with the location.
#      FTA:
#        type: string
#        description: Franchise tax area associated with the location.
#      lobProductServiceability:
#        type: array
#        items:
#          $ref: '#/definitions/LoBProductServiceability'

  LoBProductServiceability:
    properties:
      lobName: 
        type: string
        description: Line of Business (e.g. PHONE, TV, INTERNET)
      lobProduct:
        type: string
        description: Specific product within the LoB being referenced for serviceability
      lobProductServiceabilityStatus:
        type: boolean
        description: Indicator to identify if the is specified product is serviceable at the submitted location
    
  LoBLocationActiveProduct:
    properties:
      lobName: 
        type: string
        description: Line of Business (e.g. PHONE, TV, INTERNET)
      lobProduct:
        type: string
        description: Specific product within the LoB being referenced for serviceability
      biller:
        type: string
        description: Designator for which billing system serves the particular address in question 

#  locationLookupByAddress:
#    properties:
#      addressLine1:
#        type: string
#        descriprtion: <dr>
#      addressLine2:
#        type: string
#        descriprtion: <dr>
#      addressCity:
#        type: string
#        descriprtion: <dr>
#      addressStateCode:
#        type: string
#        descriprtion: <dr>
#      addressZipCode:
#        type: string
#        descriprtion: <dr>
      
