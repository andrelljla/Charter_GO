# this is draft #1 of the Orders component of the WebAPI specification for Gateway Ordering
swagger: '2.0'
info:
  title: Gateway Ordering API - Orders API
  description: Gateway Ordering Orders API
  version: "1.0.0"
# the domain of the service
host: gateway.chartercom.com
# array of all schemes that your API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /v1
produces:
  - application/json

paths:
  /orders:
    get:
      summary: Docref WXX - GetAccountOrderHistory
      description: <dr>
      parameters:
        - name: GetAccountOrderHistoryRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/GetAccountOrderHistoryRequest"
      tags:
        - WXX
      responses:
        200:
          description: Successful completion; account order history returned
          schema:
            $ref: '#/definitions/GetAccountOrderHistoryResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W01 - checkForPendingDisconnectAtLocation
  /orders/type='DISCONNECT':
    get:
      summary: Docref W01 - checkForPendingDisconnectAtLocation
      description: Determines if a pending disconnect order has been submitted for a specific location and, if so, the date that order is scheduled for completion.  Required to support the business rule that a New Connection cannot be established at a location that already has existing service unless and until that service has been disconnected.
      parameters:
        - name: GetPendingDisconnectRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/GetPendingDisconnectRequest"
      tags:
        - W1
      responses:
        200:
          description: Successful completion; pending order flag set and date(s) available as appropriate
          schema:
            $ref: '#/definitions/GetPendingDisconnectResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W08 - submitBillerOrder
  /orders/:
    put:
      summary: Docref W08 - submitBillerOrder
      description: Submits a validated order to the appropriate biller system
      parameters:
        - name: SubmitBillerOrderRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/SubmitBillerOrderRequest"
      tags:
        - W8
      responses:
        200:
          description: Successful completion; order successfully submitted to biller
          schema:
            $ref: '#/definitions/SubmitBillerOrderResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W09 - requestNewScheduleWindows
  /orders/{orderID}/schedule:
    get:
      summary: Docref W09 - requestNewScheduleWindows
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: requestNewScheduleWindowsRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/RequestNewScheduleWindowsRequest"
      tags:
        - W09
      responses:
        200:
          description: Successful completion; return key IDs
          schema:
            $ref: '#/definitions/RequestNewScheduleWindowsResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W10 - updateOrderScheduleWindow
    post:
      summary: Docref W10 - updateOrderScheduleWindow
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: updateOrderScheduleWindowRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/updateOrderScheduleWindowRequest"
      tags:
        - W10
      responses:
        200:
          description: Successful completion; order updated with select service window
          schema:
            $ref: '#/definitions/updateOrderScheduleWindowResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W12 - updateOrderConfirm
  /orders/{orderID}/confirm:
    get:
      summary: Docref W12 - updateOrderConfirm
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: updateOrderConfirmRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/updateOrderConfirmRequest"
      tags:
        - W12
      responses:
        200:
          description: Successful completion; order is confirmed (whatever that means from a business perspective)
          schema:
            $ref: '#/definitions/updateOrderConfirmResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W15 - getOrderDetails
  /orders/{orderID}:
    get:
      summary: Docref W15 - getOrderDetails
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: getOrderDetailsRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/getOrderDetailsRequest"
      tags:
        - W15
      responses:
        200:
          description: Successful completion; order details avialable for display
          schema:
            $ref: '#/definitions/getOrderDetailsResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W21 - cancelOrder
    post:
      summary: Docref W21 - cancelOrder
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: cancelOrderRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/cancelOrderRequest"
      tags:
        - W21
      responses:
        200:
          description: Successful completion; order is cancelled (status updated to CANCEL)
          schema:
            $ref: '#/definitions/cancelOrderResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

# W22 - deleteTransferRecord
  /orders/{orderID}/cancelTransfer:
    post:
      summary: Docref W22 - deleteTransferRecord
      description: <dr>
      parameters:
        - name: orderID
          in: path
          type: integer
          description: Unique identifier for the active order
        - name: deleteTransferRecordRequest
          in: body
          description: Incudes input parameters common to all invocations
          required: true
          schema: 
            $ref: "#/definitions/deleteTransferRecordRequest"
      tags:
        - W22
      responses:
        200:
          description: Successful completion; transfer record successfully deleted (soft-delete)
          schema:
            $ref: '#/definitions/deleteTransferRecordResponse'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/CommonErrorReturn'

definitions:

##############################################
#
#	Request/Response definitions
#
##############################################

  GetAccountOrderHistoryRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      GetAccountOrderHistoryInput:
        type: object
        $ref: '#/definitions/GetAccountOrderHistoryInput'
        description: <dr>
                  
  GetAccountOrderHistoryResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      GetAccountOrderHistoryReturn:
        type: object
        $ref: '#/definitions/GetAccountOrderHistoryReturn'
        description: <dr>

  GetPendingDisconnectRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      GetPendingDisconnectInput:
        type: object
        $ref: '#/definitions/GetPendingDisconnectInput'
        description: <dr>
                  
  GetPendingDisconnectResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      GetPendingDisconnectReturn:
        type: object
        $ref: '#/definitions/GetPendingDisconnectReturn'
        description: <dr>

  SubmitBillerOrderRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      SubmitBillerOrderInput:
        type: object
        $ref: '#/definitions/SubmitBillerOrderInput'
        description: <dr>
                  
  SubmitBillerOrderResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      SubmitBillerOrderReturn:
        type: object
        $ref: '#/definitions/SubmitBillerOrderReturn'
        description: <dr>

  RequestNewScheduleWindowsRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      requestNewScheduleWindowsInput:
        type: object
        $ref: '#/definitions/requestNewScheduleWindowsInput'
        description: <dr>
                  
  RequestNewScheduleWindowsResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      requestNewScheduleWindowsReturn:
        type: object
        $ref: '#/definitions/requestNewScheduleWindowsReturn'
        description: <dr>

  updateOrderScheduleWindowRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      updateOrderScheduleWindowInput:
        type: object
        $ref: '#/definitions/updateOrderScheduleWindowInput'
        description: <dr>
                  
  updateOrderScheduleWindowResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      updateOrderScheduleWindowReturn:
        type: object
        $ref: '#/definitions/updateOrderScheduleWindowReturn'
        description: <dr>

  updateOrderConfirmRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      updateOrderConfirmInput:
        type: object
        $ref: '#/definitions/updateOrderConfirmInput'
        description: <dr>
                  
  updateOrderConfirmResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      updateOrderConfirmReturn:
        type: object
        $ref: '#/definitions/updateOrderConfirmReturn'
        description: <dr>

  getOrderDetailsRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
                  
  getOrderDetailsResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      getSingleOrderDetailsReturn:
        type: object
        $ref: '#/definitions/getSingleOrderDetailsReturn'
        description: <dr>

  cancelOrderRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
      cancelOrderInput:
        type: object
        $ref: '#/definitions/cancelOrderInput'
        description: <dr>
                  
  cancelOrderResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      cancelOrderReturn:
        type: object
        $ref: '#/definitions/cancelOrderReturn'
        description: <dr>

  deleteTransferRecordRequest:
    properties:
      commonInputHeader:
        type: object
        $ref: '#/definitions/CommonInputHeader'
        description: Common parameters submitted with all service calls to support authentication, reporting, logging and troubleshooting.
                  
  deleteTransferRecordResponse:
    properties:
      commonReturn: 
        type: object
        $ref: '#/definitions/CommonNoErrorReturnHeader'
        description: <dr>
      deleteTransferRecordReturn:
        type: object
        $ref: '#/definitions/deleteTransferRecordReturn'
        description: <dr>

##############################################
#
#	Common Object definitions
#
##############################################

  CommonInputHeader:
    properties:
      username:
        type: string
        description: Encrypted username for proxy user authentication
      password:
        type: string
        description: Encrypted passaord for proxy user authentication
      invokingUser:
        type: string
        description: User name for the actual user that invoked the call (for audit purpose)
      applicationID:
        type: string
        description: Code identifying invoking application
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was invoked

  CommonNoErrorReturnHeader:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
        
  CommonErrorReturn:
    properties:
      lineageID:
        type: integer
        description: Unique transaction identifier; used for transactional error handling
      timestamp:
        type: string
        description: Time that the service call was returned
      errorInfo:
        type: array
        items:
          $ref: "#/definitions/CommonErrors"
  
  CommonErrors:
    properties:
      errCode:
        type: string
      errMessage:
        type: string
      errDescription:
        type: string
      errGUID:
        type: string

##############################################
#
#	Function-Specific Object definitions
#
##############################################

  GetAccountOrderHistoryInput:
    properties:
      accountID:
        type: integer
        description: <dr>
      accountNumber: 
        type: string
        description: <dr>
      billerID:
        type: integer
        description: Unique identifier which identifies the biller system
      ordersAfter: 
        type: string
        format: Date
        description: <dr>
        
  GetAccountOrderHistoryReturn:
    properties:
      orderHistory:
        type: array
        items:
          $ref: '#/definitions/OrderHistoryItem'
        description: <dr>

  GetPendingDisconnectInput:
    properties:
      addressID:
        type: integer
        description: Unique identifier for address/location being queried
      accountID:
        type: integer
        description: Unique identifier for account being queried
      accountNumber:
        type: string
        description: Unique identifier for account within the billing system
      billerID:
        type: integer
        description: Unique identifier which identifies the biller system
        
  GetPendingDisconnectReturn:
    properties:
      addressID:
        type: integer
        description: Unique identifier for address/location being queried
      pendingDisconnectFlag:
        type: boolean
        description: Flag indicating if a disconnect order has been submitted and scheduled
      pendingDisconnectDate:
        type: string
        format: date
        description: Date existing service is schedueled for disconnect

  SubmitBillerOrderInput:
    properties:
      NewCustomerSetupData:
        type: object
        $ref: '#/definitions/NewCustomerSetupData'
      orderContent:
        type: object
        $ref: '#/definitions/mecOfferBasedOrder'
        description: <dr>
        
  SubmitBillerOrderReturn:
    properties:
      orderID:
        type: integer
        description: Unique identifier for the order, as generated by the biller isolation system
      installationRequiredFlag:
        type: boolean
        description: Indicator if physical installation by technician is required 
      availableInstallWindows:
        type: array
        items:
          $ref: '#/definitions/ScheduleInstallWindow'
      orderReasonCode:
        type: string
        description: <dr>

  requestNewScheduleWindowsInput:
    properties:
      orderID:
        type: integer
        description: Unique identifier for the active order being modified
      requestedDate:
        type: string
        format: date
        description: Custoemr requested date for service window selection
        
  requestNewScheduleWindowsReturn:
    properties:
      orderActionType:
        type: string
        description: <dr>
      serviceDuration:
        type: integer
        description: Estimated duration required to complete the service call
      availableInstallWindows:
        type: array
        items:
          $ref: '#/definitions/ScheduleInstallWindow'

  updateOrderScheduleWindowInput:
    properties:
      serviceWindowID:
        type: integer
        description: Unique identifier for the activeselected service window being allocated to the order
      callFirstFlag:
        type: boolean
        description: <dr>
      callFirstTN:
        type: string
        description: <dr>
      specialInstructionsforTechnician:
        type: string
        description: <dr>
      specialInstructionsforDispatcher:
        type: string
        description: <dr>
      disconnectComments:
        type: string
        description: <dr>
      stopBillDate:
        type: string
        format: date
        description: <dr>
      
  updateOrderScheduleWindowReturn:
    properties:
      orderStatus:
        type: string
        description: <dr>

  updateOrderConfirmInput:
    properties:
      customerEmail:
        type: string
        description: <dr>
        
  updateOrderConfirmReturn:
    properties:
      orderStatus:
        type: string
        description: <dr>
        
  getSingleOrderDetailsReturn:
    properties:
      orderDetail:
        type: object
        description: <dr>
        $ref: '#/definitions/mecOfferBasedOrder'

  cancelOrderInput:
    properties:
      orderStatus:
        type: string
        description: <dr>
        
  cancelOrderReturn:
    properties:
      orderStatus:
        type: string
        description: <dr>
        
  deleteTransferRecordReturn:
    properties:
      orderStatus:
        type: string
        description: <dr>

  ScheduleInstallWindow:
    properties:
      windowID:
        type: integer
        description: Unique identifier for the schedule window as defined by the scheduling system
      windowDate:
        type: string
        format: date
        description: <dr>
      windowStartTime:
        type: string
        description: <dr>
      windowEndTime:
        type: string
        description: <dr>
      windowTimeZone:
        type: string
        description: <dr>
        
  mecOfferBasedOrder:
    properties:
      orderActionType:
        type: string
        description: <dr>
      orderEngineOrderID:
        type: integer
        description: <dr>
      requestedInstallDate:
        type: string
        description: <dr>
      configuredOffers:
        type: array
        items:
          $ref: '#/definitions/validatedMECOffer'
        description: <dr>
      
  validatedMECOffer:
    properties:
      offerID:
        type: integer
        description: <dr>
      offerLOBName:
        type: string
        description: <dr>
      offerLOBListPrice:
        type: number
        description: <dr>
      offerComponents:
        type: array
        items:
          $ref: '#/definitions/offerComponent'
        description: <dr>
      offerAttributes:
        type: array
        items:
          $ref: '#/definitions/componentAttribute'
        description: <dr>
      
  offerComponent:
    properties:
      componentName:
        type: string
        description: <dr>
      componentPrice:
        type: number
        description: <dr>
      componentAttributes:
        type: array
        items:
          $ref: '#/definitions/componentAttribute'
        description: <dr>
      subComponents:
        type: array
        items:
          $ref: '#/definitions/offerComponent'
        description: <dr>
  
  componentAttribute:
    properties:
      attributeName:
        type: string
        description: <dr>
      attributeValue:
        type: string
        description: <dr>
  
  NewCustomerSetupData:
    properties:
      addressID:
        type: integer
        description: <dr>
      salesAgentID:
        type: integer
        description: <dr>
      customerID:
        type: integer
        description: <dr>
      customerNumber:
        type: string
        description: <dr>
      firstName:
        type: string
        description: <dr>
      lastName:
        type: string
        description: <dr>
      primaryTN:
        type: string
        description: <dr>
      primaryTNType:
        type: string
        description: <dr>
      alternateTN:
        type: string
        description: <dr>
      alternateTNType:
        type: string
        description: <dr>
      email:
        type: string
        description: <dr>
      customerType:
        type: string
        description: <dr>

  OrderHistoryItem:
    properties:
      orderID:
        type: integer
        description: <dr>
      orderInstallDate:
        type: string
        description: Actual service date for completed orders; scheduled service date for pending or in-process orders.
      orderInstallTime:
        type: string
        description: Actual service time for completed orders; scheduled service time for pending or in-process orders.
      orderPhoneNumber:
        type: string
        description: <dr>
      orderContent:
        type: object
        $ref: '#/definitions/mecOfferBasedOrder'
        
